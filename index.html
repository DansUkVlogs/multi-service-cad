<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Role Selector - British Empire CAD System</title>
  <link rel="stylesheet" href="index.css">
  <link rel="icon" href="imgs/icon.png" type="image/png">
</head>
<body>
  <header style="text-align: center; margin: 40px 0;">
    <img src="imgs/logo.png" alt="Logo" style="width: 150px; height: auto; margin-bottom: 10px; border: 2px solid #ccc; border-radius: 10px;">
    <h1 style="margin: 0; font-size: 2em;">Role Selector - British Empire CAD System</h1>
    <h3 class="instructionPrompt">Please Click a Counter Below To Go To Its Page</h3>
    <div id="connection-status" class="connection-status">
      <span class="status-dot"></span>
      <span class="status-text">Connecting...</span>
    </div>
    <div id="active-counts-container" class="active-counts-container">
      <div class="counters-grid">
        <div class="counter-item clickable-counter" data-role="police" data-url="police/police.html">
          <img src="imgs/counter-icons/police-icon.png" alt="Police" class="counter-icon">
          <div class="counter-label">Police</div>
          <div class="counter-number">
            <div class="number-scroll" id="count-police" data-value="0">0</div>
          </div>
        </div>
        <div class="counter-item clickable-counter" data-role="ambulance" data-url="ambulance/ambulance.html">
          <img src="imgs/counter-icons/ambulance-icon.png" alt="Ambulance" class="counter-icon">
          <div class="counter-label">Ambulance</div>
          <div class="counter-number">
            <div class="number-scroll" id="count-ambulance" data-value="0">0</div>
          </div>
        </div>
        <div class="counter-item clickable-counter" data-role="fire" data-url="fire/fire.html">
          <img src="imgs/counter-icons/fire-icon.png" alt="Fire" class="counter-icon">
          <div class="counter-label">Fire</div>
          <div class="counter-number">
            <div class="number-scroll" id="count-fire" data-value="0">0</div>
          </div>
        </div>
        <div class="counter-item clickable-counter" data-role="dispatch" data-url="dispatch/dispatch.html">
          <img src="imgs/counter-icons/dispatch-icon.png" alt="Dispatchers" class="counter-icon">
          <div class="counter-label">Dispatchers</div>
          <div class="counter-number">
            <div class="number-scroll" id="count-dispatchers" data-value="0">0</div>
          </div>
        </div>
        <div class="counter-item clickable-counter" data-role="civilian" data-url="civilian/civilian.html">
          <img src="imgs/counter-icons/civilian-icon.png" alt="Civilians" class="counter-icon">
          <div class="counter-label">Civilians</div>
          <div class="counter-number">
            <div class="number-scroll" id="count-ccivilians" data-value="0">0</div>
          </div>
        </div>
        <div class="counter-item clickable-counter total-counter" data-role="admin" data-url="admin/admin.html">
          <div class="counter-icon-placeholder">Œ£</div>
          <div class="counter-label">Total</div>
          <div class="counter-number">
            <div class="number-scroll" id="count-total" data-value="0">0</div>
          </div>
        </div>
      </div>
    </div>
  </header>
  <main style="text-align: center; margin-top: 20px;">
    <!-- User Info Modal -->
    <div id="userInfoModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.55);z-index:9999;align-items:center;justify-content:center;">
      <div style="background:#fff;padding:36px 32px 28px 32px;border-radius:18px;box-shadow:0 8px 32px rgba(30,60,90,0.18);min-width:320px;max-width:95vw;text-align:center;">
        <h2 style="margin-bottom:18px;">Enter Your Info</h2>
        <div style="margin-bottom:18px;">
          <label for="discordName" style="font-weight:bold;">Discord Name</label><br>
          <input id="discordName" type="text" style="width:90%;padding:10px 14px;margin-top:6px;border-radius:7px;border:1.5px solid #bbb;font-size:1.1em;" placeholder="e.g. JohnDoe#1234">
        </div>
        <div style="margin-bottom:18px;">
          <label for="irlName" style="font-weight:bold;">IRL Name</label><br>
          <input id="irlName" type="text" style="width:90%;padding:10px 14px;margin-top:6px;border-radius:7px;border:1.5px solid #bbb;font-size:1.1em;" placeholder="e.g. John Smith">
        </div>
        <button id="userInfoSubmitBtn" style="background:#1976d2;color:#fff;padding:12px 32px;border:none;border-radius:8px;font-weight:bold;font-size:1.15em;">Continue</button>
      </div>
    </div>
  </main>
  
  <div id="civilianModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" id="closeModal">&times;</span>
        <h2>Saved Civilian Details</h2>
        <div id="civilianDetails"></div>
        <button id="loadCivilianBtn">Load Civilian</button>
        <button id="proceedWithoutCivilianBtn">Proceed Without Civilian</button>
    </div>
</div>
  
  <script type="module" src="firebase/firebase.js"></script>
  <script type="module" src="index.js"></script>
  <!-- Admin Login Modal -->
  <div id="adminLoginModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.65);z-index:10000;align-items:center;justify-content:center;">
    <div style="background:#fff;padding:36px 32px 28px 32px;border-radius:18px;box-shadow:0 8px 32px rgba(139,69,19,0.25);min-width:380px;max-width:95vw;text-align:center;border:2px solid #8b4513;">
      <h2 style="margin-bottom:18px;color:#8b4513;font-size:1.8rem;">üîê Admin Access</h2>
      <p style="margin-bottom:24px;color:#666;font-size:1.1rem;">Enter admin credentials to access the control panel</p>
      <div style="margin-bottom:18px;">
        <label for="adminUsername" style="font-weight:bold;color:#8b4513;">Username</label><br>
        <input id="adminUsername" type="text" style="width:90%;padding:12px 14px;margin-top:6px;border-radius:8px;border:2px solid #d2b48c;font-size:1.1em;" placeholder="Enter username" autocomplete="username">
      </div>
      <div style="margin-bottom:24px;">
        <label for="adminPassword" style="font-weight:bold;color:#8b4513;">Password</label><br>
        <input id="adminPassword" type="password" style="width:90%;padding:12px 14px;margin-top:6px;border-radius:8px;border:2px solid #d2b48c;font-size:1.1em;" placeholder="Enter password" autocomplete="current-password">
      </div>
      <div style="display:flex;gap:12px;justify-content:center;">
        <button id="adminLoginBtn" style="background:#8b4513;color:#fff;padding:12px 24px;border:none;border-radius:8px;font-weight:bold;font-size:1.1em;cursor:pointer;">Login</button>
        <button id="adminCancelBtn" style="background:#999;color:#fff;padding:12px 24px;border:none;border-radius:8px;font-weight:bold;font-size:1.1em;cursor:pointer;">Cancel</button>
      </div>
      <div id="adminLoginError" style="color:#d32f2f;margin-top:12px;font-weight:bold;display:none;"></div>
    </div>
  </div>

  <script>
  // Add click handlers for counter navigation
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.clickable-counter').forEach(counter => {
      counter.addEventListener('click', function() {
        const role = counter.getAttribute('data-role');
        const url = counter.getAttribute('data-url');
        
        // Check if this is the admin/total counter
        if (role === 'admin') {
          showAdminLoginModal();
          return;
        }
        
        // Store role in localStorage for compatibility
        localStorage.setItem('userRole', role);
        
        // Add click effect
        counter.style.transform = 'scale(0.95)';
        setTimeout(() => {
          counter.style.transform = '';
          window.location.href = url;
        }, 150);
      });
    });

    // Admin login modal functionality
    function showAdminLoginModal() {
      const modal = document.getElementById('adminLoginModal');
      modal.style.display = 'flex';
      document.getElementById('adminUsername').focus();
    }

    function hideAdminLoginModal() {
      const modal = document.getElementById('adminLoginModal');
      modal.style.display = 'none';
      document.getElementById('adminUsername').value = '';
      document.getElementById('adminPassword').value = '';
      document.getElementById('adminLoginError').style.display = 'none';
    }

    function showAdminError(message) {
      const errorDiv = document.getElementById('adminLoginError');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';
    }

    function validateAdminLogin() {
      const username = document.getElementById('adminUsername').value.trim();
      const password = document.getElementById('adminPassword').value.trim();
      
      // Simple validation (username: admin, password: admin)
      if (username === 'admin' && password === 'admin') {
        // Store admin session
        sessionStorage.setItem('adminLoggedIn', 'true');
        sessionStorage.setItem('adminLoginTime', Date.now().toString());
        
        // Navigate to admin page
        window.location.href = 'admin/admin.html';
      } else {
        showAdminError('Invalid username or password');
        // Clear password field
        document.getElementById('adminPassword').value = '';
        document.getElementById('adminPassword').focus();
      }
    }

    // Event listeners for admin modal
    document.getElementById('adminLoginBtn').addEventListener('click', validateAdminLogin);
    document.getElementById('adminCancelBtn').addEventListener('click', hideAdminLoginModal);
    
    // Allow Enter key to submit login
    document.getElementById('adminPassword').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        validateAdminLogin();
      }
    });
    
    // Close modal when clicking outside
    document.getElementById('adminLoginModal').addEventListener('click', function(e) {
      if (e.target === this) {
        hideAdminLoginModal();
      }
    });
  });
  </script>
</body>
</html>
